
<!DOCTYPE html>
<html lang="zh-CN" class="loading">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Vshow | Domi</title>

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate">
    <meta name="keywords" content="Vshow,"> 
    <meta name="description" content="vshow博客,"> 
    <meta name="author" content="vshow"> 
    
    <link rel="icon" href="/img/favicon.png"> 
    <link rel="stylesheet" href="/css/diaspora.css">
<link rel="stylesheet" href="/css/rest.css">
</head>
</html>
<body class="loading">
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
  <div class="bar" style="width: 0;"></div>
  <a class="icon-home image-icon" href="javascript:;"></a>
  <div title="播放/暂停" class="icon-play"></div>
  <h3 class="subtitle">令人眼前一亮的 Vue 实战技巧</h3>
  <div class="social">
    <!--<div class="like-icon">-->
    <!--<a href="javascript:;" class="likeThis active"><span class="icon-like"></span><span class="count">76</span></a>-->
    <!--</div>-->
    <div>
      <div class="share" hidden>
        <a title="获取二维码" class="icon-scan" href="javascript:;"></a>
      </div>
      <div id="qr">
        <img src="/img/wechat.png" alt="" srcset="" />
        <p>微信扫一扫</p>
        <p>关注该公众号</p>
      </div>
    </div>
  </div>
  <div class="scrollbar"></div>
</div>

    <div class="section">
        <div class="article">
    <div class='main'>
        <h1 class="title">令人眼前一亮的 Vue 实战技巧</h1>
        <div class="stuff">
            <span>三月 25, 2022</span>
            

        </div>
        <div class="content markdown">
            <h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>本文主要介绍日常项目开发过程中的一些技巧，不仅可以帮助提升工作效率，还能提高应用的性能。以下是我总结一些平时工作中的技巧。</p>
<h4 id="minxin-让组件复用灵活化"><a href="#minxin-让组件复用灵活化" class="headerlink" title="minxin 让组件复用灵活化"></a>minxin 让组件复用灵活化</h4><p>Vue提供了minxin这种在组件内插入组件属性的方法，个人建议这货能少用就少用，但是有个场景则非常建议使用minxin：当某段代码重复出现在多个组件中，并且这个重复的代码块很大的时候，将其作为一个minxin常常能给后期的维护带来很大的方便。</p>
<p>比如我们在项目中封装一个列表功能，有下拉刷新，加载自动请求数据，上拉加载下一页数据等等，代码如下：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    data() &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            page: <span class="number">1</span>,</span><br><span class="line">            limit: <span class="number">10</span>,</span><br><span class="line">            busy: <span class="literal">false</span>, <span class="comment">// 请求拦截，防止多次加载</span></span><br><span class="line">            finish: <span class="literal">false</span>, <span class="comment">// 是否请求完成，用于页面展示效果</span></span><br><span class="line">            pageList: [], <span class="comment">// 页面数据</span></span><br><span class="line">            reqParams: &#123;&#125;, <span class="comment">// 页面请求参数，可被改变的</span></span><br><span class="line">            defaultParams: &#123;&#125;, <span class="comment">// 页面请求参数，下拉刷新不会被重置的改变</span></span><br><span class="line">            routeName: <span class="string">''</span>, <span class="comment">// 特殊情况，页面需要复用别人的list的时候</span></span><br><span class="line">            autoReq: <span class="literal">true</span>, <span class="comment">// onload是否自己去请求</span></span><br><span class="line">            lodingText: <span class="string">''</span>, <span class="comment">// 请求中底部显示的文案</span></span><br><span class="line">            noDataText: <span class="string">'暂无数据'</span>, <span class="comment">// 自定义无数据文案</span></span><br><span class="line">            lastText: <span class="string">'- 我是有底线的 -'</span>,</span><br><span class="line">            noData: <span class="literal">false</span>, <span class="comment">// 页面无数据</span></span><br><span class="line">            reqName: <span class="string">''</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    created() &#123;</span><br><span class="line">        <span class="keyword">this</span>.autoReq &amp;&amp; <span class="keyword">this</span>.initPage(<span class="literal">false</span>, <span class="literal">true</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    onPullDownRefresh() &#123;</span><br><span class="line">        <span class="keyword">this</span>.pullDownRefreshFn()</span><br><span class="line">    &#125;,</span><br><span class="line">    onReachBottom() &#123;</span><br><span class="line">        <span class="keyword">this</span>.reachBottomFn()</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">        <span class="comment">// 重置初始化数据</span></span><br><span class="line">        initPage(saveParams = <span class="literal">true</span>, refresh = <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="comment">// 初始化所有变量</span></span><br><span class="line">            <span class="keyword">this</span>.page = <span class="number">1</span></span><br><span class="line">            <span class="keyword">this</span>.busy = <span class="literal">false</span></span><br><span class="line">            <span class="keyword">this</span>.finish = <span class="literal">false</span></span><br><span class="line">            <span class="keyword">this</span>.noData = <span class="literal">false</span></span><br><span class="line">            <span class="keyword">this</span>.lodingText = <span class="string">'数据加载中'</span></span><br><span class="line">            <span class="keyword">if</span> (saveParams) &#123;</span><br><span class="line">                <span class="keyword">const</span> &#123; page, limit &#125; = <span class="keyword">this</span>.reqParams</span><br><span class="line">                page ? <span class="keyword">this</span>.page = page : <span class="string">''</span></span><br><span class="line">                limit ? <span class="keyword">this</span>.limit = limit : <span class="string">''</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">this</span>.reqParams = &#123;&#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">this</span>.getCommonList(refresh)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// 下拉刷新函数</span></span><br><span class="line">        pullDownRefreshFn() &#123;</span><br><span class="line">            <span class="keyword">this</span>.initData()</span><br><span class="line">            <span class="keyword">this</span>.initPage(<span class="literal">false</span>, <span class="literal">true</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// 上啦加载函数</span></span><br><span class="line">        reachBottomFn() &#123;</span><br><span class="line">            <span class="keyword">this</span>.getCommonList()</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// 重置数据,方便调用（一般在外面自定义清空一些数据）</span></span><br><span class="line">        initData() &#123; <span class="comment">// 重置data里面的变量，方便外面引用这个mixin的时候，下拉刷新重置变量</span></span><br><span class="line"></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// 列表获取数据接口</span></span><br><span class="line">        <span class="keyword">async</span> getCommonList(refresh) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">this</span>.reqName) <span class="keyword">return</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.busy) <span class="keyword">return</span></span><br><span class="line">            <span class="keyword">this</span>.busy = <span class="literal">true</span></span><br><span class="line">            <span class="keyword">this</span>.finish = <span class="literal">false</span></span><br><span class="line">            <span class="keyword">const</span> httpFn = <span class="keyword">this</span>.$http || getApp().globalData.$http<span class="comment">// 兼容nvue</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">const</span> query = &#123;</span><br><span class="line">                    ...this.defaultParams,</span><br><span class="line">                    ...this.reqParams,</span><br><span class="line">                    page: <span class="keyword">this</span>.page,</span><br><span class="line">                    limit: <span class="keyword">this</span>.limit</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">const</span> &#123; data &#125; = <span class="keyword">await</span> httpFn(<span class="keyword">this</span>.reqName, query)</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">this</span>.page === <span class="number">1</span>) <span class="keyword">this</span>.pageList = []</span><br><span class="line">                <span class="comment">/**</span></span><br><span class="line"><span class="comment">                 * [Node.JS中用concat和push连接两个或多个数组的性能比较](http://ourjs.com/detail/5cb3fe1c44b4031138b4a1e2)</span></span><br><span class="line"><span class="comment">                 * 那么两者在node.js的性能如何？ 我们做了一组测试数据，两种分别测试100万次。</span></span><br><span class="line"><span class="comment">                 * push比concat方法快3倍左右。因为push只是在原数组的基础上进行修改，所以会快一点。</span></span><br><span class="line"><span class="comment">                 * push返回的是数组的长度，所以没重新定义变量再判断了</span></span><br><span class="line"><span class="comment">                 * [Array.prototype.push.apply(arr1, arr2)无法自动触发DOM更新](https://www.imooc.com/wenda/detail/494323)</span></span><br><span class="line"><span class="comment">                 * 因为 this.pageList.push !== Array.prototype.push,，this.pageList.push指向的是vue重写过的方法</span></span><br><span class="line"><span class="comment">                 */</span></span><br><span class="line">                <span class="keyword">this</span>.finish = <span class="literal">true</span></span><br><span class="line">                <span class="keyword">const</span> resLen = data.list ? data.list.length : <span class="number">0</span></span><br><span class="line">                <span class="keyword">if</span> (resLen === <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">this</span>.resSuccess(data, refresh)</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">const</span> listLen = <span class="keyword">this</span>.pageList.push.apply(<span class="keyword">this</span>.pageList, data.list)</span><br><span class="line">                <span class="keyword">if</span> (listLen &lt; data.count &amp;&amp; <span class="keyword">this</span>.limit &lt;= resLen) &#123; <span class="comment">// 说明还有数据</span></span><br><span class="line">                    <span class="keyword">this</span>.busy = <span class="literal">false</span></span><br><span class="line">                    <span class="keyword">this</span>.page = <span class="built_in">Math</span>.ceil(listLen / <span class="keyword">this</span>.limit) + <span class="number">1</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">this</span>.resSuccess(data, refresh)</span><br><span class="line">            &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">                <span class="comment">// 防止接口报错锁死</span></span><br><span class="line">                <span class="keyword">this</span>.busy = <span class="literal">false</span></span><br><span class="line">                <span class="keyword">this</span>.finish = <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        resSuccess(data, refresh) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.finish &amp;&amp; <span class="keyword">this</span>.busy) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">this</span>.pageList.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">this</span>.$nextTick(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                            <span class="keyword">this</span>.lodingText = <span class="keyword">this</span>.lastText</span><br><span class="line">                        &#125;, <span class="number">100</span>)</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">this</span>.lodingText = <span class="keyword">this</span>.noDataText</span><br><span class="line">                    <span class="keyword">this</span>.noData = <span class="literal">true</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            refresh &amp;&amp; uni.stopPullDownRefresh()</span><br><span class="line">            <span class="keyword">this</span>.finishInit(data)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// 请求完成做点什么（方便外面导入的文件自己引用）</span></span><br><span class="line">        finishInit(data) &#123; <span class="comment">// 请求完成做点什么</span></span><br><span class="line">            <span class="comment">// console.log('列表请求完成');</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>很多人看到这样场景，应该会好奇为什么不封装成一个组件？由于很多列表样式不尽相同，所以封装成一个组件可扩展性不高。但我们可以通过minxin来简化代码：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"c-recommend-goods"</span>&gt;</span><br><span class="line">    &lt;!-- 列表样式 --&gt;</span><br><span class="line">    &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">""</span> v-<span class="keyword">for</span>=<span class="string">"item in pageList"</span> :key=<span class="string">"item.id"</span>&gt;&#123;&#123;item&#125;&#125;&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">    &lt;!-- 空状态&amp;&amp; 加载中等小提示 --&gt;</span></span><br><span class="line"><span class="regexp">    &lt;c-no-data v-if="lodingText" :show-img="noData" :text="lodingText"&gt;&lt;/</span>c-no-data&gt;</span><br><span class="line">  &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">import</span> listMixins <span class="keyword">from</span> <span class="string">'@/common/mixins/list.js'</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  mixins: [listMixins],</span><br><span class="line">  data() &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      autoReq: <span class="literal">false</span>, <span class="comment">// 进入页面自动请求数据</span></span><br><span class="line">      reqParams: &#123;&#125;, <span class="comment">// 请求参数</span></span><br><span class="line">      reqName: <span class="string">'userCompanyList'</span> <span class="comment">// 请求地址</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;style&gt;&lt;/</span>style&gt;</span><br></pre></td></tr></table></figure></p>
<p>我们只要定义请求参数和请求的地址，还有列表的样式，就能实现一个不错的列表功能。</p>
<h4 id="拯救繁乱的template–render函数"><a href="#拯救繁乱的template–render函数" class="headerlink" title="拯救繁乱的template–render函数"></a>拯救繁乱的template–render函数</h4><p>有时候项目中template里存在一值多判断，如果按照下方代码书写业务逻辑，代码冗余且杂乱。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h1 v-<span class="keyword">if</span>=<span class="string">"level === 1"</span>&gt;</span><br><span class="line">      &lt;slot&gt;&lt;<span class="regexp">/slot&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>h1&gt;</span><br><span class="line">    &lt;h2 v-<span class="keyword">else</span>-<span class="keyword">if</span>=<span class="string">"level === 2"</span>&gt;</span><br><span class="line">      &lt;slot&gt;&lt;<span class="regexp">/slot&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>h2&gt;</span><br><span class="line">    &lt;h3 v-<span class="keyword">else</span>-<span class="keyword">if</span>=<span class="string">"level === 3"</span>&gt;</span><br><span class="line">      &lt;slot&gt;&lt;<span class="regexp">/slot&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>h3&gt;</span><br><span class="line">    &lt;h4 v-<span class="keyword">else</span>-<span class="keyword">if</span>=<span class="string">"level === 4"</span>&gt;</span><br><span class="line">      &lt;slot&gt;&lt;<span class="regexp">/slot&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>h4&gt;</span><br><span class="line">    &lt;h5 v-<span class="keyword">else</span>-<span class="keyword">if</span>=<span class="string">"level === 5"</span>&gt;</span><br><span class="line">      &lt;slot&gt;&lt;<span class="regexp">/slot&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>h5&gt;</span><br><span class="line">    &lt;h6 v-<span class="keyword">else</span>-<span class="keyword">if</span>=<span class="string">"level === 6"</span>&gt;</span><br><span class="line">      &lt;slot&gt;&lt;<span class="regexp">/slot&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>h6&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;&#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  props: &#123;</span><br><span class="line">    level: &#123;</span><br><span class="line">      type: <span class="built_in">Number</span>,</span><br><span class="line">      required: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>现在使用 render 函数重写上面的例子：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    props: &#123;</span><br><span class="line">      level: &#123;</span><br><span class="line">        <span class="built_in">require</span>: <span class="literal">true</span>,</span><br><span class="line">        type: <span class="built_in">Number</span>,</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    render(createElement) &#123;</span><br><span class="line">      <span class="keyword">return</span> createElement(<span class="string">'h'</span> + <span class="keyword">this</span>.level, <span class="keyword">this</span>.$slots.default);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure></p>
<h4 id="一劳永逸的组件注册"><a href="#一劳永逸的组件注册" class="headerlink" title="一劳永逸的组件注册"></a>一劳永逸的组件注册</h4><p>组件使用前，需要引入后再注册：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> BaseButton <span class="keyword">from</span> <span class="string">'./baseButton'</span></span><br><span class="line"><span class="keyword">import</span> BaseIcon <span class="keyword">from</span> <span class="string">'./baseIcon'</span></span><br><span class="line"><span class="keyword">import</span> BaseInput <span class="keyword">from</span> <span class="string">'./baseInput'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    BaseButton,</span><br><span class="line">    BaseIcon,</span><br><span class="line">    BaseInput</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>现在 BaseButton、 BaseIcon和BaseInput都可以在模板中使用了：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;BaseInput</span><br><span class="line">  v-model=<span class="string">"searchText"</span></span><br><span class="line">  @keydown.enter=<span class="string">"search"</span></span><br><span class="line">/&gt;</span><br><span class="line">&lt;BaseButton @click=<span class="string">"search"</span>&gt;</span><br><span class="line">  &lt;BaseIcon name=<span class="string">"search"</span>/&gt;</span><br><span class="line">&lt;<span class="regexp">/BaseButton&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>但如果组件多了后，每次都要先导入每个你想使用的组件，然后再注册组件，便会新增很多代码量！我们应该如何优化呢？</p>
<p>这时，我们需要借助一下webpack的require.context() 方法来创建自己的（模块）上下文，从而实现自动动态require组件。这个方法需要3个参数：要搜索的文件夹目录，是否还应该搜索它的子目录，以及一个匹配文件的正则表达式。</p>
<p>我们先在components文件夹（这里面都是些高频组件）添加一个叫global.js的文件，在这个文件里使用require.context 动态将需要的高频组件统统打包进来。然后在main.js文件中引入global.js的文件。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  global.js文件</span></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">changeStr</span> (<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> str.charAt(<span class="number">0</span>).toUpperCase() + str.slice(<span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> requireComponent = <span class="built_in">require</span>.context(<span class="string">'./'</span>, <span class="literal">false</span>, /\.vue$/)</span><br><span class="line"><span class="comment">// 查找同级目录下以vue结尾的组件</span></span><br><span class="line"><span class="keyword">const</span> install = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  requireComponent.keys().forEach(<span class="function"><span class="params">fileName</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> config = requireComponent(fileName)</span><br><span class="line">    <span class="built_in">console</span>.log(config) <span class="comment">// ./child1.vue 然后用正则拿到child1</span></span><br><span class="line">    <span class="keyword">let</span> componentName = changeStr(</span><br><span class="line">      fileName.replace(<span class="regexp">/^\.\//</span>, <span class="string">''</span>).replace(<span class="regexp">/\.\w+$/</span>, <span class="string">''</span>)</span><br><span class="line">    )</span><br><span class="line">    Vue.component(componentName, config.default || config)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  install <span class="comment">// 对外暴露install方法</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> index <span class="keyword">from</span> <span class="string">'./components/global.js'</span></span><br><span class="line">Vue.use(index)</span><br></pre></td></tr></table></figure></p>
<p>最后我们就可以随时随地在页面中使用这些高频组件，无需再手动一个个引入了。</p>
<h4 id="隐藏的大招–hook"><a href="#隐藏的大招–hook" class="headerlink" title="隐藏的大招–hook"></a>隐藏的大招–hook</h4><p>开发过程中我们有时候要创建一个定时器，在组件被销毁之前，这个定时器也要销毁。代码如下：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mounted() &#123;</span><br><span class="line">  <span class="comment">// 创建一个定时器</span></span><br><span class="line">    <span class="keyword">this</span>.timer = setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// ......</span></span><br><span class="line">    &#125;, <span class="number">500</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 销毁这个定时器。</span></span><br><span class="line">  beforeDestroy() &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.timer) &#123;</span><br><span class="line">      clearInterval(<span class="keyword">this</span>.timer);</span><br><span class="line">      <span class="keyword">this</span>.timer = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>这种写法有个很明显的弊端：定时器timer的创建和清理并不是在一个地方，这样很容易导致忘记去清理！</p>
<p>我们可以借助hook对代码整合，这样代码也更容易维护了：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mounted() &#123;</span><br><span class="line">    <span class="keyword">let</span> timer = setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// ......</span></span><br><span class="line">    &#125;, <span class="number">500</span>);</span><br><span class="line">    <span class="keyword">this</span>.$once(<span class="string">"hook:beforeDestroy"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (timer) &#123;</span><br><span class="line">        clearInterval(timer);</span><br><span class="line">        timer = <span class="literal">null</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>在Vue组件中，可以用过once去监听所有的生命周期钩子函数，如监听组件的updated钩子函数可以写成 this.$on(‘hook:updated’, () =&gt; {})。</p>
<p>hook除了上面的运用外，还可以外部监听组件的生命周期函数。在某些情况下，我们需要在父组件中了解一个子组件何时被创建、挂载或更新。</p>
<p>比如，如果你要在第三方组件 CustomSelect 渲染时监听其 updated 钩子，可以通过@hook:updated来实现：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!--通过@hook:updated监听组件的updated生命钩子函数--&gt;</span><br><span class="line">  &lt;!--组件的所有生命周期钩子都可以通过@hook:钩子函数名 来监听触发--&gt;</span><br><span class="line">  &lt;custom-select @hook:updated=<span class="string">"doSomething"</span> /&gt;</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">import CustomSelect from "../</span>components/custom-select<span class="string">";</span></span><br><span class="line"><span class="string">export default &#123;</span></span><br><span class="line"><span class="string">  components: &#123;</span></span><br><span class="line"><span class="string">    CustomSelect</span></span><br><span class="line"><span class="string">  &#125;,</span></span><br><span class="line"><span class="string">  methods: &#123;</span></span><br><span class="line"><span class="string">    doSomething() &#123;</span></span><br><span class="line"><span class="string">      console.log("</span>custom-select组件的updated钩子函数被触发<span class="string">");</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;;</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br></pre></td></tr></table></figure></p>
<h4 id="简单暴力的router-key"><a href="#简单暴力的router-key" class="headerlink" title="简单暴力的router key"></a>简单暴力的router key</h4><p>我们在项目开发时，可能会遇到这样问题:当页面切换到同一个路由但不同参数地址时，比如/detail/1，跳转到/detail/2，页面跳转后数据竟然没更新？路由配置如下：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">     path: <span class="string">"/detail/:id"</span>,</span><br><span class="line">     name:<span class="string">"detail"</span>,</span><br><span class="line">     component: Detail</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></p>
<p>这是因为vue-router会识别出两个路由使用的是同一个组件从而进行复用，并不会重新创建组件，而且组件的生命周期钩子自然也不会被触发，导致跳转后数据没有更新。那我们如何解决这个问题呢？我们可以为router-view组件添加属性key,例子如下：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;router-view :key=<span class="string">"$route.fullpath"</span>&gt;&lt;<span class="regexp">/router-view&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>这种办法主要是利用虚拟DOM在渲染时候通过key来对比两个节点是否相同，如果key不相同，就会判定router-view组件是一个新节点，从而先销毁组件，然后再重新创建新组件，这样组件内的生命周期会重新触发。</p>
<h4 id="高精度权限控制–自定义指令directive"><a href="#高精度权限控制–自定义指令directive" class="headerlink" title="高精度权限控制–自定义指令directive"></a>高精度权限控制–自定义指令directive</h4><p>我们通常给一个元素添加v-if / v-show，来判断该用户是否有权限，但如果判断条件繁琐且多个地方需要判断，这种方式的代码不仅不优雅而且冗余。针对这种情况，我们可以封装了一个指令权限，能简单快速的实现按钮级别的权限判断。我们先在新建个array.js文件，用于存放与权限相关的全局函数<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// array.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">checkArray</span> (<span class="params">key</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> arr = [<span class="string">'admin'</span>, <span class="string">'editor'</span>]</span><br><span class="line">  <span class="keyword">let</span> index = arr.indexOf(key)</span><br><span class="line">  <span class="keyword">if</span> (index &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span> <span class="comment">// 有权限</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span> <span class="comment">// 无权限</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>然后在将array文件挂载到全局中<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; checkArray &#125; <span class="keyword">from</span> <span class="string">"./common/array"</span>;</span><br><span class="line">Vue.config.productionTip = <span class="literal">false</span>;</span><br><span class="line">Vue.directive(<span class="string">"permission"</span>, &#123;</span><br><span class="line">  inserted (el, binding) &#123;</span><br><span class="line">    <span class="keyword">let</span> permission = binding.value; <span class="comment">// 获取到 v-permission的值</span></span><br><span class="line">    <span class="keyword">if</span> (permission) &#123;</span><br><span class="line">      <span class="keyword">let</span> hasPermission = checkArray(permission);</span><br><span class="line">      <span class="keyword">if</span> (!hasPermission) &#123; <span class="comment">// 没有权限 移除Dom元素</span></span><br><span class="line">        el.parentNode &amp;&amp; el.parentNode.removeChild(el);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>最后我们在页面中就可以通过自定义指令 v-permission来判断：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"btns"</span>&gt;</span><br><span class="line">    &lt;button v-permission=<span class="string">"'admin'"</span>&gt;权限按钮<span class="number">1</span>&lt;<span class="regexp">/button&gt;  /</span><span class="regexp">/ 会显示</span></span><br><span class="line"><span class="regexp">    &lt;button v-permission="'visitor'"&gt;权限按钮2&lt;/</span>button&gt; <span class="comment">//无显示</span></span><br><span class="line">    &lt;button v-permission=<span class="string">"'editor'"</span>&gt;权限按钮<span class="number">3</span>&lt;<span class="regexp">/button&gt; /</span><span class="regexp">/ 会显示</span></span><br><span class="line"><span class="regexp">  &lt;/</span>div&gt;</span><br></pre></td></tr></table></figure></p>
<p><img src="/img/20220329190142.png" alt="编码"></p>
<h4 id="动态指令参数"><a href="#动态指令参数" class="headerlink" title="动态指令参数"></a>动态指令参数</h4><p>Vue 2.6的最酷功能之一是可以将指令参数动态传递给组件。我们可以用方括号括起来的 JavaScript 表达式作为一个指令的参数：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a v-bind:[attributeName]=&quot;url&quot;&gt; 这是个链接 &lt;/a&gt;</span><br></pre></td></tr></table></figure></p>
<p>这里的 attributeName 会被作为一个 JavaScript 表达式进行动态求值，求得的值将会作为最终的参数来使用。同样地，你可以使用动态参数为一个动态的事件名绑定处理函数：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a v-on:[eventName]=&quot;doSomething&quot;&gt; 这是个链接 &lt;/a&gt;</span><br></pre></td></tr></table></figure></p>
<p>接下来我们看个例子：假设你有一个按钮，在某些情况下想监听单击事件，在某些情况下想监听双击事件。这时动态指令参数派上用场：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;aButton @[someEvent]=<span class="string">"handleSomeEvent()"</span> /&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  data () &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      someEvent: someCondition ? <span class="string">"click"</span> : <span class="string">"dbclick"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    handleSomeEvent () &#123;</span><br><span class="line">      <span class="comment">// handle some event</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure></p>
<h4 id="过滤器让数据处理更便利"><a href="#过滤器让数据处理更便利" class="headerlink" title="过滤器让数据处理更便利"></a>过滤器让数据处理更便利</h4><p>Vue.js 允许你自定义过滤器，它的用法其实是很简单，但是可能有些朋友没有用过，接下来我们介绍下：</p>
<h5 id="1-理解过滤器"><a href="#1-理解过滤器" class="headerlink" title="1.理解过滤器"></a>1.理解过滤器</h5><ul>
<li>功能：对要显示的数据进行特定格式化后再显示。</li>
<li>注意：过滤器并没有改变原本的数据，需要对展现的数据进行包装。</li>
<li>使用场景：双花括号插值和 v-bind 表达式 (后者从 2.1.0+ 开始支持)。<h5 id="2-定义过滤器"><a href="#2-定义过滤器" class="headerlink" title="2.定义过滤器"></a>2.定义过滤器</h5>可以在一个组件的选项中定义本地的过滤器：<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">filters: &#123;</span><br><span class="line">  capitalize: <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!value) <span class="keyword">return</span> <span class="string">''</span></span><br><span class="line">    value = value.toString()</span><br><span class="line">    <span class="keyword">return</span> value.charAt(<span class="number">0</span>).toUpperCase() + value.slice(<span class="number">1</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>也可以在创建 Vue 实例之前全局定义过滤器</p>
<h5 id="3-使用过滤器"><a href="#3-使用过滤器" class="headerlink" title="3.使用过滤器"></a>3.使用过滤器</h5><p>使用方法也简单，即在双花括号中使用管道符(pipeline) |隔开<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 在双花括号中 --&gt;</span><br><span class="line">&lt;div&gt;&#123;&#123; myData| filterName&#125;&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;div&gt;&#123;&#123; myData| filterName(arg)&#125;&#125;&lt;/</span>div&gt;</span><br><span class="line">&lt;!-- 在 v-bind 中 --&gt;</span><br><span class="line">&lt;div v-bind:id=<span class="string">"rawId | formatId"</span>&gt;&lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>过滤器可以串联：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; message | filterA | filterB &#125;&#125;</span><br></pre></td></tr></table></figure></p>
<p>在这个例子中，filterA 被定义为接收单个参数的过滤器函数，表达式 message 的值将作为参数传入到函数中。然后继续调用同样被定义为接收单个参数的过滤器函数 filterB，将 filterA 的结果传递到 filterB 中。接下来我们看个如何使用过滤器格式化日期的例子：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">    &lt;h2&gt;显示格式化的日期时间&lt;<span class="regexp">/h2&gt;</span></span><br><span class="line"><span class="regexp">    &lt;p&gt;&#123;&#123; date &#125;&#125;&lt;/</span>p&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123; date | filterDate &#125;&#125;&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">    &lt;p&gt;年月日: &#123;&#123; date | filterDate("YYYY-MM-DD") &#125;&#125;&lt;/</span>p&gt;</span><br><span class="line"> &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp"> ......</span></span><br><span class="line"><span class="regexp">  filters: &#123;</span></span><br><span class="line"><span class="regexp">    filterDate(value, format = "YYYY-MM-DD HH:mm:ss") &#123;</span></span><br><span class="line"><span class="regexp">      console.log(this)/</span><span class="regexp">/undefined 过滤器没有this指向的</span></span><br><span class="line"><span class="regexp">      return moment(value).format(format);</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  data() &#123;</span></span><br><span class="line"><span class="regexp">    return &#123;</span></span><br><span class="line"><span class="regexp">      date: new Date()</span></span><br><span class="line"><span class="regexp">    &#125;;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/20220329190555.png" alt="编码"></p>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" preload="auto" controls="controls" data-autoplay="true">
                <source type="audio/mpeg" src="">
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                        <li title='0' data-url='http://f.dooomi.com/media/%E5%91%A8%E6%9D%B0%E4%BC%A6%20-%20%E5%91%8A%E7%99%BD%E6%B0%94%E7%90%83.mp3'></li>
                    
                        <li title='1' data-url='http://f.dooomi.com/media/%E5%A5%BD%E5%96%9C%E6%AC%A2%E4%BD%A0.mp3'></li>
                    
                        <li title='2' data-url='http://f.dooomi.com/media/%E6%B1%AA%E8%8B%8F%E6%B3%B7%20-%20%E4%B8%80%E7%AC%91%E5%80%BE%E5%9F%8E.mp3'></li>
                    
                        <li title='3' data-url='http://f.dooomi.com/media/%E6%B1%AA%E8%8B%8F%E6%B3%B7%20-%20%E6%9C%89%E7%82%B9%E7%94%9C.mp3'></li>
                    
                        <li title='4' data-url='http://f.dooomi.com/media/%E8%AE%B8%E5%B5%A9%20-%20%E7%BB%9D%E4%BB%A3%E9%A3%8E%E5%8D%8E.mp3'></li>
                    
                </ul>
            
        </div>
        

    </div>
    
        <div class='side'>
            <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#前言"><span class="toc-text">前言</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#minxin-让组件复用灵活化"><span class="toc-text">minxin 让组件复用灵活化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#拯救繁乱的template–render函数"><span class="toc-text">拯救繁乱的template–render函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#一劳永逸的组件注册"><span class="toc-text">一劳永逸的组件注册</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#隐藏的大招–hook"><span class="toc-text">隐藏的大招–hook</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#简单暴力的router-key"><span class="toc-text">简单暴力的router key</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#高精度权限控制–自定义指令directive"><span class="toc-text">高精度权限控制–自定义指令directive</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#动态指令参数"><span class="toc-text">动态指令参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#过滤器让数据处理更便利"><span class="toc-text">过滤器让数据处理更便利</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-理解过滤器"><span class="toc-text">1.理解过滤器</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-定义过滤器"><span class="toc-text">2.定义过滤器</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-使用过滤器"><span class="toc-text">3.使用过滤器</span></a></li></ol></li></ol>
        </div>
    
</div>


    </div>
</div>
</body>
<script src="https://cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="http://f.dooomi.com/js/plugin.min.js"></script>
<script src="/js/diaspora.js"></script>
<script src="/js/index.js"></script>
<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">
<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?fd4a84e32c3f25a40cc5947c1e50561d";
        var s = document.getElementsByTagName("script")[0]; 
        s.parentNode.insertBefore(hm, s);
    })();
</script>
    
</html>